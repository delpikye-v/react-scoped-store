import e,{useRef as t,useEffect as n}from"react";var r=function(){function e(e){this.listeners=new Set,this.state=e}return e.prototype.getState=function(){return this.state},e.prototype.setState=function(e){var t="function"==typeof e?e(this.state):e;this.state=Object.assign({},this.state,t),this.emit()},e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){return t.listeners.delete(e)}},e.prototype.destroy=function(){this.listeners.clear()},e.prototype.emit=function(){this.listeners.forEach((function(e){return e()}))},e}();function u(e){return function(){return new r(e())}}function o(e){var t={exports:{}};return e(t,t.exports),t.exports}var i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=e.useState,a=e.useEffect,c=e.useLayoutEffect,f=e.useDebugValue;function l(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!i(e,n)}catch(e){return!0}}var _="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=s({inst:{value:n,getSnapshot:t}}),u=r[0].inst,o=r[1];return c((function(){u.value=n,u.getSnapshot=t,l(u)&&o({inst:u})}),[e,n,t]),a((function(){return l(u)&&o({inst:u}),e((function(){l(u)&&o({inst:u})}))}),[e]),f(n),n},O={useSyncExternalStore:void 0!==e.useSyncExternalStore?e.useSyncExternalStore:_},d=o((function(t,n){"production"!==process.env.NODE_ENV&&function(){function t(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!u(e,n)}catch(e){return!0}}"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var r=e,u="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},o=r.useState,i=r.useEffect,s=r.useLayoutEffect,a=r.useDebugValue,c=!1,f=!1,l="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,n){c||void 0===r.startTransition||(c=!0,console.error("You are using an outdated, pre-release alpha of React 18 that does not support useSyncExternalStore. The use-sync-external-store shim will not work correctly. Upgrade to a newer pre-release."));var l=n();if(!f){var _=n();u(l,_)||(console.error("The result of getSnapshot should be cached to avoid an infinite loop"),f=!0)}var O=(_=o({inst:{value:l,getSnapshot:n}}))[0].inst,d=_[1];return s((function(){O.value=l,O.getSnapshot=n,t(O)&&d({inst:O})}),[e,l,n]),i((function(){return t(O)&&d({inst:O}),e((function(){t(O)&&d({inst:O})}))}),[e]),a(l),l};n.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:l,"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}()})),S=o((function(e){"production"===process.env.NODE_ENV?e.exports=O:e.exports=d}));function v(e){var r=t(null);r.current||(r.current=e());var u=r.current,o=S.useSyncExternalStore(u.subscribe.bind(u),u.getState.bind(u),u.getState.bind(u));return n((function(){return function(){u.destroy()}}),[u]),{state:o,setState:u.setState.bind(u),store:u}}var p="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},E=S.useSyncExternalStore,y=e.useRef,L=e.useEffect,h=e.useMemo,b=e.useDebugValue,g={useSyncExternalStoreWithSelector:function(e,t,n,r,u){var o=y(null);if(null===o.current){var i={hasValue:!1,value:null};o.current=i}else i=o.current;o=h((function(){function e(e){if(!a){if(a=!0,o=e,e=r(e),void 0!==u&&i.hasValue){var t=i.value;if(u(t,e))return s=t}return s=e}if(t=s,p(o,e))return t;var n=r(e);return void 0!==u&&u(t,n)?(o=e,t):(o=e,s=n)}var o,s,a=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]}),[t,n,r,u]);var s=E(e,o[0],o[1]);return L((function(){i.hasValue=!0,i.value=s}),[s]),b(s),s}},T=o((function(t,n){"production"!==process.env.NODE_ENV&&function(){"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var t=e,r=S,u="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},o=r.useSyncExternalStore,i=t.useRef,s=t.useEffect,a=t.useMemo,c=t.useDebugValue;n.useSyncExternalStoreWithSelector=function(e,t,n,r,f){var l=i(null);if(null===l.current){var _={hasValue:!1,value:null};l.current=_}else _=l.current;l=a((function(){function e(e){if(!s){if(s=!0,o=e,e=r(e),void 0!==f&&_.hasValue){var t=_.value;if(f(t,e))return i=t}return i=e}if(t=i,u(o,e))return t;var n=r(e);return void 0!==f&&f(t,n)?(o=e,t):(o=e,i=n)}var o,i,s=!1,a=void 0===n?null:n;return[function(){return e(t())},null===a?void 0:function(){return e(a())}]}),[t,n,r,f]);var O=o(e,l[0],l[1]);return s((function(){_.hasValue=!0,_.value=O}),[O]),c(O),O},"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}()})),V=o((function(e){"production"===process.env.NODE_ENV?e.exports=g:e.exports=T}));function A(e,t,n){return void 0===n&&(n=Object.is),V.useSyncExternalStoreWithSelector(e.subscribe.bind(e),e.getState.bind(e),e.getState.bind(e),t,n)}export{r as ScopedStore,u as createScopedStore,A as useScopedSelector,v as useScopedStore};
